<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>Yi's Website</title><meta name="author" content="Yi Qiu"><link rel="shortcut icon" href="/img/favicon.png"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head><body><header id="page_header"><div class="header_wrap"><div id="blog_name"><a class="blog_title" id="site-name" href="/">Yi's Website</a></div><button class="menus_icon"><div class="navicon"></div></button><ul class="menus_items"><li class="menus_item"><a class="site-page" href="/research"> Research Experiences</a></li><li class="menus_item"><a class="site-page" href="/About-me"> About Me</a></li><li class="menus_item"><a class="site-page" href="/Blogs-Notes"> Blogs</a></li><li class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://yiqiu99.github.io/arXiv Daily/"> ArXiv Notes</a></li><li class="menus_item"><a class="site-page" href="/Gallery"> Gallery</a></li></ul><!-- Theme Switcher (added here)--><div id="header-theme"><input type="checkbox" id="theme-switch"><label for="theme-switch"></label></div></div></header><main id="page_main"><div class="side-card sticky"><div class="card-wrap" itemscope itemtype="http://schema.org/Person"><div class="author-avatar"><img class="avatar-img" src="/img/MEold.JPG" onerror="this.onerror=null;this.src='/img/MEold.JPG'" alt="avatar"></div><div class="author-discrip"><h3>Yi Qiu</h3><p class="author-bio">Ph.D. student in Physics Department of Pennsylvania State University.</p></div><div class="author-links"><button class="btn m-social-links">Links</button><ul class="social-links"><li><a class="e-social-link" href="mailto:yiqiu@psu.edu" target="_blank"><i class="fas fa-envelope" aria-hidden="true"></i><span>yiqiu@psu.edu</span></a></li></ul></div><a class="cv-links" href="/attaches/CV_2025.pdf" target="_blank"><i class="fas fa-file-pdf" aria-hidden="true"><span>My CV</span></i></a></div></div><div class="page" itemscope itemtype="http://schema.org/CreativeWork"><h2 class="page-title"></h2><article><h2 id="section">3-21</h2>
<p>Informed by Alex I was selected!!!</p>
<h2 id="section-1">3-29</h2>
<p>First email from Xisco--ask about availability.</p>
<h2 id="section-2">4-7</h2>
<p>First email talk with Pierre.:)</p>
<p>I was sent recommended papers to read in advance from both of them.</p>
<p>https://arxiv.org/abs/1903.08284</p>
<p>https://arxiv.org/abs/1905.00869</p>
<p>https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5253841/pdf/41114_2016_Article_2.pdf</p>
<p>https://arxiv.org/pdf/gr-qc/0309007.pdf</p>
<p>https://arxiv.org/pdf/gr-qc/0309007.pdf</p>
<p>https://arxiv.org/pdf/1910.08708.pdf</p>
<h2 id="section-3">5-11</h2>
<p>First meet with Xisco and Pierre :)</p>
<p>Short discussion + 3 projects for training.</p>
<h2 id="section-4">6-21</h2>
<p>Q1</p>
<p>Why choose the start time to be 2.3M?</p>
<p>Try to plot the difference between</p>
<p>Q2</p>
<p>Why does the oscillation of alpha/beta1 fitting happen?</p>
<p>try to include with early time data</p>
<p>Q3</p>
<p>Why was the estimation of spin is worse than the mass's?</p>
<p>l=2 m=2 mode</p>
<p>Xisco's paper in 2015</p>
<h2 id="section-5">6-28</h2>
<p>What had I done last week?</p>
<ul>
<li><p>Plot the difference (relative/absolute deviation) between model with different fit starting time on every point. (With Dhruv's help)</p>
<p>try higher overtones</p></li>
<li><p>Try with another list of estimation parameters and compare them with Xisco's. (one magnitude above with data from Python qnm)</p></li>
<li><p>Try to extract mass and spin from <span class="math inline">\(\alpha_0\)</span> and <span class="math inline">\(\beta_0\)</span></p></li>
</ul>
<p>Question?</p>
<ol type="1">
<li>What's the quality of different qnm results (calculate in different ways)</li>
</ol>
<p>Use the 2,0 mode!!!</p>
<p>Try also compare the Berti's table of Qnm</p>
<ol type="1">
<li><p>What's the meaning of the estimation from <span class="math inline">\(\alpha_0\)</span> and <span class="math inline">\(\beta_0\)</span> to MASS and SPIN?</p>
<p>To what extent should fundamental tone model be modified by alpha and beta, and how it can be done by comparing the two estimation.</p></li>
</ol>
<h2 id="section-6">7-5</h2>
<ol type="1">
<li>Talk about alpha and beta</li>
</ol>
<ul>
<li>try with other fitting model</li>
<li>fits higher overtones</li>
</ul>
<ol type="1">
<li><p>GWdata have 200 mode?</p></li>
<li><p>NRdata have other spin mass or m unequal 0 mode?</p>
<p>PROBABLY IN PROGRESS</p></li>
</ol>
<h2 id="section-7">7-6</h2>
<p>Yesterday's presentation is a good experience for me, I found that I am still vague to a lot of knowledge related to my work. Actually, this could be a serious problem! Xisco and Pierre, they are very nice, they give me some advices and now I decided to ask more questions and keep a working dairy like this everyday.</p>
<p>Q1: maximum electric charge of final black hole after merger that has been detected so far?</p>
<h2 id="section-8">7-12</h2>
<p>What have I done for the last week?</p>
<ul>
<li>Try to find a better model.</li>
<li>Try to modify the computation from QNM to BH's mass and spin with alpha0 and beta0 in higher overtone models.</li>
<li>Spend some time to understand the shear modes.</li>
</ul>
<p>Results</p>
<ul>
<li>Found a rational model that seemed better.</li>
<li>Maybe the alphas and betas are really needed for such computation.</li>
</ul>
<p>Question?</p>
<ol type="1">
<li>Why were the fitting results different?</li>
<li>Maximum electric charge of final black hole after merger that has been detected so far?</li>
</ol>
<p>Plan</p>
<ol type="1">
<li>Try to find the model from the wave equation.</li>
<li>Connect to Atlas and try with even higher overtones.</li>
<li>Reading papers!</li>
</ol>
<h2 id="section-9">7-14</h2>
<ol type="1">
<li>Discuss about the fit.</li>
<li>Show the markdown version of potential presentation next week.</li>
<li>Talk about plans and todolist for this week.</li>
</ol>
<h2 id="section-10">7-19</h2>
<ol type="1">
<li><p>Discuss about the fit.</p></li>
<li><p>Question:</p>
<ul>
<li><p>Why are the alpha&amp;betas still unstable when using the higher overtones?</p></li>
<li><p>Should I change to another language/method (like Scipy) and see the fitting results of them?</p>
<ul>
<li><p>Modify the fit still in Mathematica.</p></li>
<li><p>Gwnrdata mass=0.952032939704, spin=0.692085186818.</p></li>
<li><p>Error bar.</p></li>
</ul></li>
</ul></li>
</ol>
<h2 id="section-11">7-23</h2>
<ol type="1">
<li><p>Talk about the results. Using <a target="_blank" rel="noopener" href="https://mathematica.stackexchange.com/questions/31070/problem-with-nonlinearmodelfit-the-function-value-is-not-a-list-of-real-num">constraints</a> in the fit.</p>
<ul>
<li><p>try to use negative fit starting time.</p></li>
<li><p>error bar plot.</p></li>
<li><p><strong>omega, 1/tau as functions of spin (mass=1).</strong> (remember to divide by mass)</p>
<p>omega(m,a) = omega(m=1,a)/m,</p>
<p>tau(m,a) = m/(oneOverTau(m=1,a).</p></li>
</ul></li>
</ol>
<h2 id="section-12">7-29</h2>
<ol type="1">
<li><p>Questions about the data requirement for Pierre's code. Ask about whether I should re-run the same code.</p>
<p>sxsdir="/Users/xisco/SXS/SXS_New"; ritdir="/Users/xisco/RIT"; seldirs="~/Desktop/RDFits/sxsdirs.dat";</p>
<p>mysxscasemetafile=FileNames["metadata.json",mysxscase,2][[1]] ==metadata===Import[mysxscasemetafile]; ==h5file===FileNames["<em>rhOverM</em>",mysxscase,2]</p></li>
<li><p>Work in progress:</p>
<p>Fitting alpha, beta——tested for some days, track the fitting and try to improve.</p>
<p>Introduce</p></li>
<li><p>About the preprint paper (if still have time).</p>
<ul>
<li>Why was local discrepancy so small?</li>
<li>Is the radiation error come from SXS data production process?</li>
</ul></li>
<li><p>About how to read arXiv daily (if still have time).</p></li>
</ol>
<h2 id="section-13">8-2</h2>
<ol type="1">
<li>Questions:
<ul>
<li>The gwnr data before t=0?</li>
<li>What to do when mass/spin hit an edge?</li>
<li>Why can't the .m code work?</li>
<li>How to speed up the fitringdowngrid function?</li>
</ul></li>
<li><ul>
<li>In different n_max model, see the t-epsilon plot.</li>
<li>Try set the alpha and beta instead of fitting them. 10%-20%.</li>
</ul></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh condor1.atlas.aei.uni-hannover.de</span><br></pre></td></tr></table></figure>
<p>scp -r condor1.atlas.aei.uni-hannover.de:/work/francisco.jimenez/SXS/data/SXS_BBH_0305 /Users/qe/downloads/RDownData</p>
<p>Host atlas1 atlas2 atlas3 atlas4 condor1 condor2 condor3 condor4 condor5 condor6 condor7 condor8 condor9 condorp condori Hostname %h.atlas.aei.uni-hannover.de IdentitiesOnly yes IdentityFile ~/.ssh/id_ed25519-atlas User pierre.mourier ServerAliveInterval 60 ServerAliveCountMax 5</p>
<h2 id="section-14">8-6</h2>
<ol type="1">
<li>Results:
<ul>
<li>Alpha/Betas may be highly correlated with mass/spin.</li>
<li>T-epsilon plot.</li>
</ul></li>
<li>Keep in mind
<ul>
<li>Massrange-low-like 1.3. Follow the rule Xisco sent in main zoom chat.</li>
<li>{0.2,1.2} for nmax=3.</li>
<li>Complex data.</li>
</ul></li>
</ol>
<h2 id="section-15">8-9</h2>
<ol type="1">
<li><p>Results:</p>
<ul>
<li>t-epsilon plot.</li>
</ul></li>
<li><p>Questions:</p>
<ul>
<li>Is there any other dataset?</li>
</ul></li>
<li><p>to do</p>
<ul>
<li><p>try to plot both real and complex t-epsilon.</p></li>
<li><p>try with higher overtones for setting alpha and beta manually.</p></li>
</ul></li>
</ol>
<h2 id="section-16">8-11</h2>
<ol type="1">
<li>Ideas:
<ul>
<li>Fit for the last alpha and beta.</li>
<li>Slope/relative deviation (epsilon-deviation)-nmax plot?</li>
<li>Mismatch plot of modifying the highest tones.</li>
<li>Extend the deviation range of pp cases (500%).</li>
<li>Try with (0,p), (p,0) ...
<ul>
<li>Try with another mass ratio data.</li>
</ul></li>
</ul></li>
<li>Submit jobs:
<ul>
<li>scp /Users/qe/Downloads/overtones-project_Yi/codes/RdownCode/qnmdataint.mx condor1.atlas.aei.uni-hannover.de:/work/yi.qiu/Overtone/job8-25</li>
<li>scp -r condor4.atlas.aei.uni-hannover.de:/work/yi.qiu/Overtone/job8-12/result1 /Users/qe/Desktop</li>
<li>condor_submit condor_submit_test1.sub</li>
</ul></li>
</ol>
<h2 id="section-17">8-13</h2>
<ol type="1">
<li>Results
<ul>
<li>Fit for the last alpha and beta.</li>
<li>Extend the range of deviation &amp; add p0, 0p... cases.</li>
<li>Mismatch plot of modifying the highest tones.</li>
</ul></li>
<li>Suggestions?
<ul>
<li>ReIm option, adding the calculation of covariance matrix in the function CNMinizer.</li>
<li>Try with just the real part and see their parameter table (attempt 1).</li>
<li>Extract the amplitude out of the fitringdowngrid function.</li>
<li>Logscale the mismatch.</li>
<li>Set alpha0 &amp;beta0 (alpha1 &amp;beta1) to be free, and fit for n-(0,7).</li>
</ul></li>
</ol>
<h2 id="section-18">8-14</h2>
<p>Submit jobs:</p>
<ul>
<li>scp condor4.atlas.aei.uni-hannover.de:/work/yi.qiu/Overtone/job8-17/epstable0iter7.wdx /Users/qe/Desktop</li>
<li>condor_submit condor_submit_test1.sub</li>
<li>condor_q</li>
</ul>
<h2 id="section-19">8-16</h2>
<ol type="1">
<li>Problem
<ul>
<li>New .m package conflicts with the old one.</li>
<li>Which algorithms to use?</li>
</ul></li>
<li>Plans for next steps
<ul>
<li>To make the contourplot for the epsilons. (Keep all the warnings.)</li>
<li>Amplitude evolution with the alpha &amp; betas.(Plus-Plus)</li>
<li>Set alpha0 &amp;beta0 (alpha1 &amp;beta1(separately and together)) to be free, and fit for n-(0,7).</li>
<li><strong><u><em>Logscale</em></u></strong></li>
<li>1/cosh(t/tau)</li>
</ul></li>
</ol>
<h2 id="section-20">8-17</h2>
<ul>
<li>source /work/dhruv.sharma/py3env_1/bin/activate</li>
<li>scp -r condor4.atlas.aei.uni-hannover.de:/work/yi.qiu/Overtone/job8-25 /Users/qe/Desktop/perturbed/result</li>
<li>"Executable"-&gt;"/work/dhruv.sharma/py3env_1/bin/python"</li>
<li>condor_submit condor_submit_test1.sub</li>
</ul>
<h2 id="section-21">8-18</h2>
<ul>
<li>Try to copy the local interpolation file to the Atlas.</li>
<li>Globally transform the time coordinate.</li>
<li>Set different initial point.</li>
<li>Presentation:
<ol type="1">
<li>overtone model —&gt; plots on epsilon.</li>
<li>overtone model with alpha and beta—&gt; plots on epsilon.</li>
<li>perturbed overtone model —&gt; plots on epsilon.</li>
</ol></li>
</ul>
<h2 id="section-22">8-20</h2>
<p>Questions:</p>
<ol type="1">
<li>Which original models should we compare with the modified ones?</li>
<li>Modify only the loweat (fundamental) tone, and see the evolution of the modified values with the nmax, then combine the results with the highest tone modification to give an overall stability measurement?</li>
</ol>
<p>Suggest:</p>
<ol type="1">
<li>Add the 0,1 tone case to all the researches.</li>
<li>Change the interval/step.</li>
<li>Compare between the adding best alpha/beta with n+1 modified model.</li>
</ol>
<h2 id="section-23">8-23</h2>
<ol type="1">
<li>Questions
<ul>
<li>Why is the ringdown part of the template waveform (like what Yifan showed last week) dieviating from the theoretical damped-sin wave so much?</li>
<li>A1: The waveform was generated in a perturbed (non-GR) theory.</li>
<li>A2: There are cutoffs used in the frequency-spectrum, which would affect the form of high mass BBHs event.</li>
</ul></li>
<li>To do list
<ul>
<li>Adding constraints to the FindMinimum[{x Cos[x], 1 &lt;= x &lt;= 15}, {x, 7}].</li>
<li>Compile the functions</li>
</ul></li>
<li>Simran's pre
<ul>
<li>What is the valid-with the known parameters.</li>
<li>First step is signal alarm-which can give a time slice sample, then we can do whether match flitering or machine learning.</li>
<li>After building the network, we compare the loss function of training dataset and validaiton dataset, to see if the loss is truly decresing with the iterations or the model is just overfitting.</li>
</ul></li>
</ol>
<h2 id="section-24">8-25</h2>
<ol type="1">
<li>Things to add in the appendix:https://www.its.caltech.edu/~kip/PubScans/II-175.pdf.</li>
<li>Results:</li>
</ol>
<ul>
<li>Both <u>compile</u> and <u>adding constaints</u> to the findminimun function seemed to significantly increase the running time. (about factor of 5~10)</li>
<li>Found a way to do nonlinearmodelfit with complex ansatz.</li>
<li>Plot part of the results.</li>
</ul>
<p>Questions:</p>
<ul>
<li>How to have median/standard deviation of epsilon and plot the error bar?</li>
<li>What does one iteration mean in Mathematica, and how does it work with the constraints?</li>
<li>What to do if the job is held in Atlas?</li>
</ul>
<p>Todo:</p>
<ul>
<li>The same plot with mismatch of each models.</li>
<li>epsilon-mismatch in log-log scale.</li>
<li>Extend the analysis to N=10.</li>
<li>Try with the output I already have to plot the error bar.</li>
<li>Condor is one of the cluster mannagers. Linux program. ==sbatch==.</li>
</ul>
<h2 id="section-25">8-31</h2>
<ol type="1">
<li>Questions:
<ul>
<li>Do we only need to consider the tones that have its mismatch above the NR errors (10^(-5))? Like a 4 overtone model?</li>
</ul></li>
<li>To do:
<ul>
<li>Try to add the error bar to the alpha and beta.</li>
<li>tone0 + tone1 with a1,b1 vs. tone0 + tone1 + tone2 vs. tone0 + tone1 + xp t^gamma vs. ...</li>
<li>in the grid of the alpha and beta-{-0.2,0.2 -0.5,0.5}, to refine the step and search for high resolution alpha/beta. (for n=0)</li>
</ul></li>
</ol>
<h2 id="section-26">9-3</h2>
<ol type="1">
<li><p>Schedule for 45 mins:</p>
<ul>
<li>10min~15min discuss about yesterday's argument.</li>
<li>5min draw a conclusion about it.</li>
<li>15min discuss about other 2 results of last time suggestions.</li>
<li>10~15min about paper writting.</li>
</ul></li>
<li><p>To be discussed</p>
<ul>
<li><p>Fix the initial value of alpha and beta to be zero in the second approach.</p></li>
<li><p>To extend the mismatch approach of abgrid to 7 tones.</p></li>
<li><p>averaging alpha/beta square. sqrt(_{i=1...N}(xi) / N)</p></li>
<li><p>What potentially can i write down for now?</p>
<ul>
<li>Other modified models.</li>
<li>Spectroscopy parameter estimation.</li>
<li>Thinking first.</li>
</ul></li>
</ul></li>
</ol>
<h2 id="section-27">9-11</h2>
<ol type="1">
<li>Get the highest tone modified models' alpha/beta values of several waveform data generated by different pairs of mass/spin.</li>
<li>==Pairwise Plot==</li>
<li>ASK if he will be in HK.</li>
</ol>
<h2 id="section-28">9-14</h2>
<ol type="1">
<li><p>Content/(TimeTable):</p>
<ul>
<li><p>mismatch results to N=7. (~5min)</p></li>
<li><p>Comparison with the epsilon approach. (~15min)</p></li>
<li><p>Perturbing each tone in N=6 model. (~5min)</p></li>
<li><p>Modified models' results. (~10min)</p></li>
<li><p>Fit starting time. (~5min)</p></li>
</ul></li>
<li><p>To do:</p>
<ul>
<li>Band width? (In order to clearly show the distribution)</li>
<li>Pair plots of 0,1 tone all perturbed.</li>
<li>Extend the tone analysis to 1-5 overtone model.</li>
</ul></li>
</ol>
<p>Suggestions:</p>
<ul>
<li>Extend the range of mismatch approach.</li>
<li>Time coordinate transformation model.</li>
<li>To use the square of alpha/beta.</li>
<li>Looking for the important.</li>
<li>Create a repository.</li>
</ul>
<h2 id="section-29">9-22</h2>
<ol type="1">
<li>New results:
<ul>
<li>Pair grid plot (Incorrect).</li>
<li>Extension of alpha_N/beta_N grid range.</li>
<li>Tone comparison.</li>
</ul></li>
<li>About the preparation of paper draft:
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/Yi-Qiu/AEI_OM-instability">Github repository</a>.</li>
<li>Overleaf project: organization of the current results. <strong>Discuss the train of thoughts.</strong></li>
</ul></li>
<li>Questions:
<ul>
<li>Should we test the fitting which we set the mass/spin as freee parameters as an extra explanation of why we use the fitringdowngrid?</li>
</ul></li>
<li>Todo list:
<ul>
<li>Distribution property of mismatch and epsilon in the alpha/beta grid.</li>
<li>Correct the 0,1 tones model.</li>
<li>To add the reference lines for the tone comparison plot.</li>
<li>Try to accelarate the codes:
<ul>
<li>TakeColumn[data, 2].</li>
<li>ToExpression["A"]-&gt;0?</li>
<li>Maxiteration.</li>
<li>Try to test some other mass/spin.</li>
</ul></li>
<li>To explain the mismatch-epsilon plot.</li>
<li>To do 0,1 modification to other Nmax.</li>
<li>Recover the 1D version of alpha/beta grid.</li>
</ul></li>
</ol>
<h2 id="section-30">10-1</h2>
<ol type="1">
<li><p>Issues and results to discuss:</p>
<ul>
<li>How to extract the <span class="math inline">\(\sigma\)</span> correctly?</li>
<li>0/1 tones modification.</li>
<li>Overflows occurred in time coordinate transformation models.</li>
<li>Paper draft: most of the plots and structure (sections/subsec./subsubsec...).</li>
</ul></li>
<li><p>Suggestions</p>
<ul>
<li><p>Try the exponential form of mis.</p></li>
<li><p>corner.py</p></li>
<li><p>fg=corner.corner(postsamps,quantiles=[0.05,0.5,0.95],show_titles=True,max_n_ticks = 4,bins=50,labels=labels,truth_color='red')</p>
<p>plt.show() if export: fg.savefig(corner_plot, format = 'png', bbox_inches = 'tight')</p></li>
<li><p>CNMinimize[RDdata[[All, 2]], ans1tTan, pars, {t, RDdata[[All, 1]]}, "Bounds" -&gt; {6 &lt;= tp &lt;= 20, 0 &lt;= [Sigma] &lt;= 100}, Method -&gt; "NelderMead", MaxIterations -&gt; 100000]</p></li>
</ul></li>
</ol>
<h2 id="section-31">10.3</h2>
<p>List:</p>
<ol type="1">
<li>Intro倒数第二段加入errorness，可能的未发现其他tone的原因。</li>
<li>intro最后一段修改</li>
<li>II add summary of analysis.</li>
<li>add subsec about mass/spin grid alpha/beta grid.</li>
<li>IV B some people argued about using diff...</li>
<li>V A 讨论两张图，并写明白为什么要研究highest tone。</li>
<li>V B 每个subsubsec加入motivation以及转场语。</li>
<li>V C discuss about the results.</li>
<li>0,1 tone perturbed subsec + 2 paras, and comparison between other works.</li>
<li>V E add motivation para.</li>
<li>V E add fig + discussion</li>
<li>VI 1 para summarize.</li>
<li>VI add para discuss about conclusions.</li>
<li>VI last about prospects.</li>
<li>Acknowledge + all summer intern members.</li>
</ol>
<h2 id="section-32">10-6</h2>
<ol type="1">
<li>New results:
<ul>
<li>TCTM.</li>
<li>0, 1 tone jointplot.</li>
</ul></li>
<li>Problems:
<ul>
<li>Interpolation of 5D data.</li>
<li>Using which SNR is more realistic?</li>
</ul></li>
<li>Paper draft:
<ul>
<li>How to proceed?</li>
</ul></li>
<li>Suggestion:
<ul>
<li>To compare the modified models with the same number of free parameters.</li>
<li>Try to use the SNR of the GW150914, and give the 90% credible contour.</li>
<li>datared = Select[test1[[All, {1, 2, 3, 4, 5}]], -0.3001 &lt; #[[3]] &lt; -0.099 &amp;]; datared = Complement[test1[[All, {1, 2, 3, 4, 5}]], datared]; test = Interpolation[datared]</li>
</ul></li>
</ol>
<h2 id="section-33">10-10</h2>
<p>Writings:</p>
<ol type="1">
<li>Read about other's first section.</li>
<li>choose the equations.</li>
<li>Write down the paragraphes.</li>
<li>modified accordingly the sub/sec labels.</li>
</ol>
<h2 id="section-34">10-13</h2>
<ol type="1">
<li>Progress:
<ul>
<li>Pairplot.</li>
<li>credible interval in progress...</li>
</ul></li>
<li>Suggestions:
<ul>
<li>(&gt; 50, e.g. 100, 300, 1000) SNRs in addition, since the numerical data has an "SNR" (data to numerical error ratio really). that is at least of the order of 10^3.</li>
<li>Try 1000000 samples in the corner plot.</li>
<li>To gather all the plots i made in the summer.</li>
<li>Cite Dhruv's paper.</li>
</ul></li>
<li>Plan:
<ul>
<li>Writings:
<ol type="1">
<li>Focusing on the results section.</li>
<li>Modify the plots.</li>
<li>Read the references. (not so important for now)</li>
<li>Firstly review one paragragh 3-4 times.</li>
</ol></li>
</ul></li>
</ol>
<h2 id="section-35">10-18</h2>
<p>In one dimension the probability of finding a sample of the normal distribution in the interval <span class="math inline">\(\mu \pm \sigma\)</span> is approximately <span class="math inline">\(68.27 \%\)</span>, but in higher dimensions the probability of finding a sample in the region of the standard deviation ellipse is lower.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Dimensionality</th>
<th style="text-align: left;">Probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">0.6827</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">0.3935</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">0.1987</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">0.0902</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">0.0374</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: left;">0.0144</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: left;">0.0052</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: left;">0.0018</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: left;">0.0006</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: left;">0.0002</td>
</tr>
</tbody>
</table>
<p>Plan:</p>
<ol type="1">
<li>Making and modifying plots in one hour per image, then add the discussions in paper for 1-1.5 hours per image. Totally 20-25 hours expected.</li>
<li>Reexaming the logic flow in texts for ~5 hours.</li>
</ol>
<h2 id="section-36">11-2</h2>
<p>Questions:</p>
<ol type="1">
<li>How to calculate the error on epsilon and mismatch?</li>
<li>In the TCTM comparison, we should consider n-1 or n tones? What do we want to present through the results of these?</li>
</ol>
<h2 id="section-37">11-5</h2>
<p>Reports:</p>
<ol type="1">
<li><p>Functions found in Isi's package:</p>
<p>https://github.com/maxisi/ringdown/blob/main/ringdown/kde_contour.py</p>
<p>which can make contours simply with percentages.</p></li>
<li><p>Corner package plot.</p>
<ul>
<li><p>Have more data points involved.</p></li>
<li><p>Plot the distribution functions as well, and combine them with the sample corner plot.</p></li>
<li><p>https://emcee.readthedocs.io/en/stable/tutorials/line/</p>
<p>nwalkers = 300 npoints = 1000 burning = 800</p></li>
</ul></li>
<li><p>Modifications to plots.</p>
<ul>
<li>t_0/M.</li>
<li>do not keep the label above the plots.</li>
<li>Makes the texts larger.</li>
</ul></li>
</ol>
<p>Questions:</p>
<ol type="1">
<li><p>Can I cite the error values on epsilon and mismatch for SXS data alone from your paper?</p>
<ul>
<li>read the plot.</li>
</ul></li>
<li><p>For the TCTM cases, should we consider n-1 or n tones? What do we want to present through the results of these?</p></li>
<li><p>Anything new can be added from the previous plots?</p></li>
<li><p>Using the corner package results for different SNR cases (or display them only in the appendix)?</p>
<p>https://stackoverflow.com/questions/60877259/plot-multiple-datasets-in-the-same-corner-plot</p></li>
<li><p>Anything new from arxiv that are highly related to our works?</p></li>
</ol>
<p>TO DO:</p>
<p>Ask Alex.</p>
<p>https://imprs-gw.aei.mpg.de/potsdam</p>
<h2 id="section-38">11-16</h2>
<ol type="1">
<li><p>MCMC sampling.</p>
<p>sigma ~ 1/rho.</p>
<p>use SNR</p></li>
<li><p>Bibgraphy problem.</p>
<p>Inspirehep_cite.</p></li>
<li><p>Draft of paper.</p></li>
</ol>
<h2 id="section-39">11-17</h2>
<p>paper:</p>
<ol type="1">
<li>modify the bibliography.</li>
<li>Edit the introduction.</li>
<li>add the 0, 1 tone perturbed part.</li>
<li>Add the funda tone part.</li>
<li>edit the conclusions.</li>
<li>Read through all of them and find the place missing cites.</li>
<li>edit the abstract and all the logic.</li>
<li>compare between mine with other papers, check the language usages.</li>
<li>Further adding some reference.</li>
<li>Add the ringdown intro part.</li>
</ol>
<p>Discussion with Xisco:</p>
<ol type="1">
<li>To check the chain results are stable.</li>
<li>To try to get the same results for the same snr with both emcee and dynesty. (from high snr first.)</li>
<li>To recover dynesty results with differentnlives.</li>
</ol>
<h2 id="section-40">11-18</h2>
<ul>
<li><p>To add the amplitude and phase to the interpolation list.</p>
<p>Arg[], Abs[]</p></li>
<li><p>To run them with parallelization in atlas.</p></li>
</ul>
<h2 id="section-41">11-24</h2>
<ol type="1">
<li>Sampling options need to be modified, otherwise too slow.</li>
</ol>
<figure>
<img src="https://raw.githubusercontent.com/EinsQE/image/master/img/20211124124113.png" alt="截屏2021-11-24 下午12.41.07" /><figcaption aria-hidden="true">截屏2021-11-24 下午12.41.07</figcaption>
</figure>
<ol start="2" type="1">
<li><p>Amplitude/phase also as interpolation objects, they would represent the explanation to the upper limit of deviations we set.</p>
<p>To use the posterior samples as the input of interpolation fucntion to make the scatter plot of amplitude.</p></li>
</ol>
<h2 id="section-42">11-26</h2>
<ol type="1">
<li>Cornerplot.</li>
<li>Potential appendix (amplitude checks.)</li>
</ol>
<p>Application:</p>
<ol type="1">
<li>Make sure about the deadlines for letters.</li>
<li>Check the specific letter requirements.</li>
</ol>
<h2 id="section-43">12-9</h2>
<ol type="1">
<li><p>Abstract:</p>
<ul>
<li>Anything inappropriate?</li>
</ul></li>
<li><p>Introduction:</p>
<ul>
<li>Issue: some parts remained copies from your paper :(</li>
<li>Should I delete them all and add something I understand for now, or should I just try to rewrite them by browsing through references and summarized them with my own languages?</li>
<li>Suggestion: Write my own words.</li>
</ul></li>
<li><p>Conclusion:</p>
<ul>
<li>Should I include some quantified explanations about details in each figure as you did or should I just conclude some important "overviews" in points?</li>
<li>Add only the important quantities.</li>
<li>The conclusions in points is small and lack explanations in details. Add more explanation.</li>
<li>Any advice about the structure?</li>
<li>We need to have an agreement first.</li>
</ul></li>
</ol>
<h2 id="section-44">1-17</h2>
<ol type="1">
<li>Use matplotlib to improve the Fig. 13457.</li>
<li>Modify the introduction.</li>
<li>Modify the abstract.</li>
<li>Fundamental tone evolution.</li>
</ol>
<h4 id="ideas">ideas</h4>
<ol type="1">
<li>Do the amplitude tests.</li>
<li>look further into the inconsistency between mismatch and epsilon analysis.</li>
</ol>
<h2 id="section-45">1-20</h2>
<h4 id="ideas-1">Ideas</h4>
<ol type="1">
<li><p>Show the amplitude test in part of the paper.</p></li>
<li><p>Look deeper into the inconsistency between mismatch and epsilon analysis.</p>
<p>Q: Should we replace the lowest mismatch by lowest epsilon in the contour plot? And also, the sampling could also be done based on the epsilon results in grid.</p></li>
</ol>
<h4 id="plan">Plan</h4>
<ol type="1">
<li>Make the contour plots (and some other plots as well) with matplotlib.</li>
<li>Modify the conclusion section.</li>
<li>To make the contour plot based on the epsilon. N=1, 3. (to make 1,2,3,4,5...if fast enough)</li>
</ol>
<h4 id="notes">Notes</h4>
<ol type="1">
<li>Numerical black hole spectroscopy.</li>
<li>Xisco's phd and postdoc institute:
<ul>
<li>Balearic Island University.</li>
<li>University of Rome.</li>
<li>Leiden University.</li>
<li>Badri Krishnan.</li>
<li>Bohr Institute of Copenhagen University.</li>
<li>Alex.</li>
</ul></li>
</ol>
<h2 id="section-46">1-21</h2>
<ol type="1">
<li>Problem:
<ul>
<li>The modified overtone models are fitted to the data by varying mass and spin first, and.</li>
</ul></li>
<li>Suggestion:
<ul>
<li>Reference lines or cross symbol.</li>
<li>Compare the contour of tctm with tone perturbed model at Nmax=3.</li>
<li>Nmax=1.</li>
</ul></li>
</ol>
<h2 id="section-47">1-25</h2>
<ol type="1">
<li>Results discussion/suggestions:
<ul>
<li>Try higher SNR.</li>
<li>Try to compute the Bayes factor
<ul>
<li>Log[evidence_model]-Log[evidence_OM]</li>
<li>Log[evidence] = result.logz</li>
<li>Check the source code of seaborn kde plot level.</li>
</ul></li>
</ul></li>
<li><u>Cut down the paper:</u> 2 plots about the tone perturbed models. 1 plot on model comparison. 1 plot on sampling results. (<em>1 plot on TCTM parameter evolution</em>)</li>
</ol>
<h2 id="section-48">2-1</h2>
<table>
<colgroup>
<col style="width: 4%" />
<col style="width: 18%" />
<col style="width: 18%" />
<col style="width: 19%" />
<col style="width: 19%" />
<col style="width: 4%" />
<col style="width: 5%" />
<col style="width: 4%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th>1.</th>
<th><span class="math inline">\(N_{max}\)</span></th>
<th><span class="math inline">\(\log_{10} \mathcal{B}^{50}_{TCTM-OM}\)</span></th>
<th><span class="math inline">\(\log_{10} \mathcal{B}^{50}_{HTPM-OM}\)</span></th>
<th><span class="math inline">\(\log_{10} \mathcal{B}^{1000}_{TCTM-OM}\)</span></th>
<th><span class="math inline">\(\log_{10} \mathcal{B}^{1000}_{HTPM-OM}\)</span></th>
<th><span class="math inline">\(N_{max}\)</span></th>
<th><span class="math inline">\(BIC_{TCTM}\)</span></th>
<th><span class="math inline">\(BIC_{OM}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td><span class="math inline">\(0.14\pm0.05\)</span></td>
<td><span class="math inline">\(N/A\)</span></td>
<td><span class="math inline">\(-109\pm0.09\)</span></td>
<td><span class="math inline">\(N/A\)</span></td>
<td>1</td>
<td>54.2</td>
<td>52.9</td>
<td><span class="math inline">\(N/A\)</span></td>
</tr>
<tr class="even">
<td>2</td>
<td><span class="math inline">\(1.56\pm0.04\)</span></td>
<td><span class="math inline">\(0.36\pm0.05\)</span></td>
<td><span class="math inline">\(254\pm0.08\)</span></td>
<td><span class="math inline">\(19.9\pm0.08\)</span></td>
<td>2</td>
<td>44.3</td>
<td>47.2</td>
<td>47.0</td>
</tr>
<tr class="odd">
<td>3</td>
<td><span class="math inline">\(0.67\pm0.03\)</span></td>
<td><span class="math inline">\(0.16\pm0.04\)</span></td>
<td><span class="math inline">\(39.0\pm0.08\)</span></td>
<td><span class="math inline">\(28.6\pm0.08\)</span></td>
<td>3</td>
<td>58.6</td>
<td>59.1</td>
<td>58.7</td>
</tr>
<tr class="even">
<td>4</td>
<td><span class="math inline">\(0.88\pm0.02\)</span></td>
<td><span class="math inline">\(0.86\pm0.02\)</span></td>
<td><span class="math inline">\(5.99\pm0.07\)</span></td>
<td><span class="math inline">\(5.17\pm0.07\)</span></td>
<td>4</td>
<td>73.3</td>
<td>73.3</td>
<td>73.3</td>
</tr>
<tr class="odd">
<td>5</td>
<td><span class="math inline">\(0.74\pm0.02\)</span></td>
<td><span class="math inline">\(N/A\)</span></td>
<td><span class="math inline">\(1.23\pm0.06\)</span></td>
<td><span class="math inline">\(N/A\)</span></td>
<td>5</td>
<td>87.9</td>
<td>87.9</td>
<td><span class="math inline">\(N/A\)</span></td>
</tr>
<tr class="even">
<td>6</td>
<td><span class="math inline">\(0.66\pm0.02\)</span></td>
<td><span class="math inline">\(N/A\)</span></td>
<td><span class="math inline">\(1.00\pm0.06\)</span></td>
<td><span class="math inline">\(N/A\)</span></td>
<td>6</td>
<td>102.6</td>
<td>102.6</td>
<td><span class="math inline">\(N/A\)</span></td>
</tr>
</tbody>
</table>
<ol start="2" type="1">
<li>Discussion/Suggestions:
<ul>
<li>Compute the BIC.</li>
<li>Try to cross-check the contours with corner.corner.</li>
<li>==Calculate with lower mass bounds (constant for all model having different tones).==</li>
<li>Sampling with other perturbation parameters.</li>
</ul></li>
</ol>
<h2 id="section-49">2-9</h2>
<ol type="1">
<li>New table (4-pars):</li>
</ol>
<table>
<thead>
<tr class="header">
<th><span class="math inline">\(N_{max}\)</span></th>
<th><span class="math inline">\(BIC_{TCTM}\)</span></th>
<th><span class="math inline">\(BIC_{OM}\)</span></th>
<th><span class="math inline">\(BIC_{HTPM}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>-9135.45</td>
<td>-9203.41</td>
<td>-5938.24</td>
</tr>
<tr class="even">
<td>2</td>
<td>-14517.6</td>
<td>-12194.2</td>
<td>-12274.7</td>
</tr>
<tr class="odd">
<td>3</td>
<td>-15270.6</td>
<td>-15103.0</td>
<td>-16887.3</td>
</tr>
<tr class="even">
<td>4</td>
<td>-21515.4</td>
<td>-18039.2</td>
<td>-20146.7</td>
</tr>
<tr class="odd">
<td>5</td>
<td>-20934.6</td>
<td>-20948.2</td>
<td>-20855.9</td>
</tr>
<tr class="even">
<td>6</td>
<td>-18896.5</td>
<td>-23197.2</td>
<td>-22197.5</td>
</tr>
</tbody>
</table>
<ol start="2" type="1">
<li><p>Suggestions:</p>
<ul>
<li><p>Check the 4-pars mass-spin distribution.</p></li>
<li><p>Check the BIC and Bayes factor trends the same or not (OM-others).</p></li>
<li><p>Improve the corner plot pipeline.</p></li>
<li><p>Try the larger range for the grids computations.</p></li>
<li><p>Try to find what is the main factor slowing down the sampling.</p></li>
<li><pre><code>    interp = LinearNDInterpolator(list(zip(w, u, x, y)), z)
    def mis(a,b,c,d):  
        result = interp(a,b,c,d)
        return result

    mis = LinearNDInterpolator(...)</code></pre></li>
</ul></li>
</ol>
<h2 id="section-50">2-10</h2>
<p>Test the speed of sampling within by changing some options to default, I found that: 1. The number of initial live-points could possibly be proportional to the runtime. 2. The 'multi' bound option of dynesty would be ~2 times faster than 'single' bound of prior, while the 'none' bound condition would be &gt;20 times slower than the 'single' bound.</p>
<p>Testing whether the interpolation is done everytime we sample or not, found that mis = LinearNDInterpolator(...) won't work, and the interpolation would always done just once.</p>
<h2 id="section-51">2-23</h2>
<p>Here are two plots showing the trend of model comparison (with both BIC and Bayes factor) in regard to Nmax as Xisco suggested. All the sampling are still done with the "mixed" as named by Pierre :) And as you taught me, the BIC would probably agree better with higher SNR cases since the contours would shrink to the limit and pin down on the optimal values of the whole parameter space, so as they getting closer to the way BIC is calculated.</p>
<figure>
<img src="/Users/qe/Desktop/Full-sampling/Fig/20220302114604.png" alt="SNR" /><figcaption aria-hidden="true">SNR</figcaption>
</figure>
<p>The <span class="math inline">\(\log_{10}\)</span> Bayes factors of TCTM vs OM are plot above, while the BICs of OM-TCTM are plotted below.</p>
<figure>
<img src="/Users/qe/Desktop/Full-sampling/Fig/20220302114637.png" alt="Untitled" /><figcaption aria-hidden="true">Untitled</figcaption>
</figure>
<p>From the two plots, we can tell that:</p>
<ol type="1">
<li>For the Nmax=0 case (Nmax=1 for the OM), with low SNR, the Bayes factors are, even though small, <strong><u> still larger than 0</u></strong>, which indicate that TCTM would be better. While for the SNR started from 100 to 1000 or above, the Nmax=0 case would have a negative Bayes factor.</li>
<li>For the Nmax=1, 2, 3, the TCTM are clearly better.</li>
<li>BIC plot would agree with the Bayes factors in they are both positive for Nmax=1, 2, 3 (though the trend from 1 to 2 is different), but be different from low SNR case in Nmax=0.</li>
</ol>
<p>In conclusion, since we could only correctly obtain Bayes factor for the <u><strong>realistic data analysis</strong></u> , with current SNR (typically less than 50), we may probably say TCTM is better. But with future detector like LISA, we may identify the real case here for the Nmax=0 model.</p>
<p>On the other hand, combining evidence found in those modified OMs allowing for QNM bias (like our HTPM), in which the damping time bias would be typically larger than frequency bias, all the facts just point to the problem exist in the time coordinate biases of ringdown signals. Would there be any degeneracy among each modification? Or, would there be some deeper mechanism of nonlinearity to be unveil? We may leave them for following works (like done on real data) to find out.</p>
<h2 id="section-52">2-25</h2>
<ol type="1">
<li>Discussions/Suggestions:
<ul>
<li>Try to find the pre-defiend function for linear fitting in python.</li>
<li>Try to make the fundamental tone OM as reference for the Bayes factor plots.</li>
<li>Add the HTPM as well.</li>
</ul></li>
<li>Advice for Master degrees application in EU.
<ul>
<li>Send a reminder to Badri.</li>
<li>Ask again.</li>
<li>Email to ENS ask about which year should I apply.</li>
</ul></li>
</ol>
<h2 id="section-53">3-2</h2>
<ol type="1">
<li>Update Xisco:
<ul>
<li>Bayes factor/BIC plots and the resulting argument.</li>
<li>Full-sampling code.</li>
<li>Last discussion of me and Pierre on the relevant contents in the draft.</li>
</ul></li>
<li>My plan:
<ul>
<li>==Run 6-pars full-sampling for the OM1-TCTM0 cases.==</li>
<li>Check other waveform data for a cross-check.</li>
</ul></li>
<li>Suggestions:
<ul>
<li>Two curves for the OM0 reference plot.</li>
<li>TCTM, HTPM, OM, EM.</li>
<li>Mass/spin contours of different models (for the OM1).</li>
<li>Test the 4-pars and 2-pars sampling on the bayes factor.</li>
<li>Try to test the flexibility of the full-ringdown OM.</li>
</ul></li>
</ol>
<h2 id="section-54">3-9</h2>
<ol type="1">
<li>Updates:
<ul>
<li>Full-sampling results (one example).</li>
<li>Using OM0 as reference.</li>
<li>4pars vs 2pars.</li>
<li>OM0-TCTM1 mass/spin contours.</li>
</ul></li>
<li>Questions:
<ul>
<li>Sampling priors on the amplitudes?</li>
</ul></li>
<li>Suggestions:
<ul>
<li>Modify the mismatch by chi square.</li>
<li>Combine the code in one file.</li>
<li>Change all the axis and label of the plots to label exactly the tone of OM (not TCTM).</li>
<li>Add the '<span class="math inline">\(Log_{10}\)</span>' to every y captions.</li>
<li>Try to obtain all the results with the new version of likelihood.</li>
<li>[0, 5] for amplitude. work in a amplitude-phase form.</li>
</ul></li>
</ol>
<h2 id="section-55">3-23</h2>
<ol type="1">
<li><p>Time consumed:</p>
<table>
<thead>
<tr class="header">
<th>OM-2amp</th>
<th>OM-amp-phase</th>
<th>TCTM</th>
<th>Boundary(double)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>20min-50min</td>
<td>100h+</td>
<td>10h+</td>
<td>~<span class="math inline">\(2\times\)</span></td>
</tr>
</tbody>
</table></li>
<li><p>Issues:</p>
<ul>
<li>Mass-spin contour and suitable priors.</li>
</ul></li>
<li><p>Suggestions:</p>
<ul>
<li><p>Try to pre-compute the data.sum().</p></li>
<li><p>Try to remove the periodic-option.</p></li>
<li><p>if spin&lt;0: qnmspec=QNM_spectrum(2,-2,0,mf_sel[i],-spin) if spin&lt;0 —&gt; m —&gt; -m —&gt; abs(spin) spin negative m-&gt;-m —&gt; omega spin positive mirror -&gt; -omega m—&gt;m</p></li>
<li><p>af = L + S1 + S2 L~ v * r S1 ~v1*RS</p>
<p>S1 ~ -c RS, S2 ~-c RS L ~ v *r - 2 c RS colision r&gt; 2RS r ~3 RS v ~ c</p>
<p>Final af= +c RS</p></li>
<li><p>normally not negative space, but</p></li>
</ul></li>
</ol>
<h2 id="section-56">3-27</h2>
<p>Reports:</p>
<ol type="1">
<li>Log_probablity is needed if we want a hard bounding.</li>
<li>Option "periodic" is only working for the sampling efficiency, so we'd better modify the prior afterward according to it.</li>
</ol>
<h2 id="section-57">3-30</h2>
<ol type="1">
<li><p>New results and runtime show.</p></li>
<li><p>Issues:</p>
<ul>
<li>TCTM double peaks.</li>
<li>Fix the prior ranges of both model for final version.</li>
</ul></li>
<li><p>f1 = h5py.File(file,'r') wt = np.exp(f1['samples/logwt'] - f1.attrs.get('log_evidence')) weights = wt/np.sum(wt)</p>
<p>sampler_dyn.logwt</p>
<p>f1['samples/logwt’]—&gt;sampler_dyn.logwt</p></li>
<li><p>Mass: [, 1.6].</p></li>
<li><p>Upload the code to github and share it to Xisco.</p></li>
</ol>
<h2 id="section-58">4-6</h2>
<ol type="1">
<li>Suggestions:
<ul>
<li>Check the full-sampling is consistent with the 2-para. sampling.</li>
<li>Use the -1 scenario for TCTM time scaling.</li>
<li>Set A and A0(restricting properly -2 to 2) to be log-prior but keep tau prior to be flat.</li>
</ul></li>
</ol>
<h2 id="section-59">4-20</h2>
<ol type="1">
<li>Updates/chats
<ul>
<li>Log_flat prior for A+A0 or only A.</li>
</ul></li>
<li>Current jobs:
<ul>
<li>Testing other datasets.
<ul>
<li><ol start="6" type="1">
<li></li>
</ol></li>
<li><ol start="150" type="1">
<li></li>
</ol></li>
</ul></li>
<li>Real data?</li>
</ul></li>
<li>Other Suggestions:
<ul>
<li>Try with more live points.</li>
</ul></li>
</ol>
<h2 id="section-60">5-4</h2>
<ol type="1">
<li><p>Updates:</p>
<ul>
<li>Priors fixed for BBH:0305.</li>
<li>New data test.</li>
</ul></li>
<li><p>Questions/Suggestions:</p>
<ul>
<li>Scri reading?
<ul>
<li>Try with python3 -m conda update -y --all.</li>
<li>I should try firstly find my h5py back.</li>
<li>Try with current catalog BBH:1221, (BBH:1222)</li>
</ul></li>
<li>Plan for writing the paper?
<ul>
<li>Try to collect all the results (just figures, no text required, overview no need to be comprehensive) before our next meet.</li>
</ul></li>
</ul></li>
</ol>
<h2 id="section-61">5-11</h2>
<ol type="1">
<li><p>Results update:</p>
<ul>
<li>Test results for samplings with more livepoints and walkers.</li>
<li>Test results for three waveforms (mass ratio, spin): 0300 (8.5, 0), ==0150== (1, 0.2), ==0305== (1.221, 0.01), 1221 (3, 0). (except the yellow ones, for the other waveform the overtone1 model is preferred over TCTM0 in low SNR cases.)</li>
<li>A summary of current results.</li>
<li>New version paper in progress.</li>
</ul></li>
<li><p>Next step?</p>
<ul>
<li>Test 0150 with high SNR.</li>
<li>Even better summary of the results: a table with the event names, their mass ratio, spin (or both initial z-component spins), and the Bayes factor between both models (at low SNR, and the one at high SNR too if you have it)</li>
<li>Modification will start from the section 6.</li>
<li>Add the Fig. 3 in appendix and in main texts we mention it as a motivation for us to use the HTPM and TCTM.</li>
<li>remove the expression of other models into appendix.</li>
<li>subsections for different waveforms, showing mass/spin contours.</li>
<li>1 particular plot showing the posteriors for A and tau (Appendix).</li>
</ul></li>
<li><p>Other suggestions:</p>
<ul>
<li><p>Write to Mike Boyle and ask about how to install them correctly (c.c. Xisco and Pierre). (don't tell specific)</p></li>
<li><p>Test with model having 8 parameters with more cores.</p></li>
<li><p>Try to figure out why the actual core numbers used in atlas is so small.</p></li>
</ul></li>
</ol>
<h2 id="section-62">5-17</h2>
<p>List:</p>
<ol type="1">
<li>Delete the former comments.</li>
<li>Delete irrelevant parts.</li>
<li>Find 3 main points (sub/section level para) to add for parts before section VI.
<ul>
<li>sampling process</li>
<li>Bayes analysis</li>
<li>modified models and appendix.</li>
</ul></li>
<li>Add the paras.</li>
<li>Make plots.</li>
<li>Add the descriptions for plots.</li>
<li>Add the paras.</li>
</ol>
<h2 id="section-63">5-18</h2>
<p>Discussion:</p>
<ul>
<li><p>Scri package installation</p></li>
<li><p>Bayes factor table:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>Mass Ratio</th>
<th>Spin</th>
<th>SNR=20</th>
<th>SNR=100</th>
<th>SNR=1000</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BBH:0150</td>
<td>1</td>
<td>0.2</td>
<td>0.687</td>
<td>10.12</td>
<td>993.35</td>
</tr>
<tr class="even">
<td>BBH:0305</td>
<td>1.221</td>
<td>0.01</td>
<td>0.247</td>
<td>-15</td>
<td>-293.49</td>
</tr>
<tr class="odd">
<td>BBH:1221</td>
<td>3</td>
<td>0</td>
<td>-0.452</td>
<td>-26.24</td>
<td>-2718.24</td>
</tr>
<tr class="even">
<td>BBH:0300</td>
<td>8.5</td>
<td>0</td>
<td>-0.339</td>
<td>-40.69</td>
<td>-4196.08</td>
</tr>
</tbody>
</table></li>
</ul>
<p>Suggestions:</p>
<ul>
<li>Try with the full version of conda.</li>
<li>Try to use 0.01 for low SNR cases.</li>
</ul>
<h2 id="section-64">5-24</h2>
<p>To do list:</p>
<ol type="1">
<li>draw the pictures (30mins).</li>
<li>set them into paper with captions (30mins).</li>
<li>fix appendix (15mins)</li>
<li>modify the content of section4 and appendix (1h)</li>
<li>Main contents of results (1h)</li>
<li>Try fix the anaconda (45mins)</li>
</ol>
<h2 id="section-65">5-25</h2>
<p>Progress:</p>
<ul>
<li>Several parts of the paper results and models.</li>
<li>Todo list: the theoretical parts of Bayes factor/sampling and intro/abstract/appendix/conclusion.</li>
<li>How about the new data? (ask Pierre)</li>
</ul>
<p>Discussion:</p>
<ul>
<li>Structure of the paper?
<ul>
<li>Try to concentrate on the 0305 and the other subsections can be reduced into 1.</li>
</ul></li>
</ul>
<p>Other Suggestions:</p>
<ul>
<li>Reduce the range of mass-spin contours.</li>
<li>Leave only the contours (and remove the marginalized dis)</li>
<li>combine the four waveform results together into 1 plot.</li>
<li>Maybe we can remove the SNR=1000 case in the contour plots.</li>
<li>Try to sample the OM0 cases as well.</li>
</ul>
<h2 id="section-66">6-1</h2>
<ol type="1">
<li>Updates:
<ul>
<li>Ext-CCE data successfully transformed.</li>
<li>Ext-CCE:0006 sampling results.</li>
<li>Paper: completed Bayes factor/sampling setup/new likelihood function parts.</li>
</ul></li>
<li>Discussion:
<ul>
<li>Main conclusions based on current results?
<ul>
<li>I just need to conclude from the normal waveform.</li>
</ul></li>
<li>Where is the bset to insert the Ext-CCE results?
<ul>
<li>Keep it outside the table/paper.</li>
</ul></li>
<li>Minor adjustment on the GetAsymptoticMultiMode function of the RDown.m package to work for.</li>
</ul></li>
<li>Other suggestions?
<ul>
<li>⟨d−m(θ⃗),d−m(θ⃗)⟩ for frequency domain inner product.</li>
<li>Calculate the actual difference between.</li>
</ul></li>
</ol>
<h2 id="section-67">6-17</h2>
<ol type="1">
<li>Updates:
<ul>
<li>Ext-CCE results.</li>
<li>New plots with OM0 posteriors included.</li>
<li>Abstract, Results and Discussion sections first version completed.</li>
</ul></li>
<li>Questions &amp; Discussion
<ul>
<li>Theoretical motivation of TCTM?
<ul>
<li>Allowing modification functionally.</li>
</ul></li>
<li>Fixing positioning of appendix plots.
<ul>
<li>Let latex decides.</li>
</ul></li>
<li>Possible explanations for why only the spinning equal mass binary waveform have TCTM better than OM?
<ul>
<li>Extreme mass ratio makes the perturbation theory assumption more ideal, thus OM are going to perform better.</li>
</ul></li>
<li>Improvements on the plots?
<ul>
<li>Adjust the padding between labels and ticks.</li>
</ul></li>
<li>First impression on the abstract?
<ul>
<li>Tell Xisco and Pierre in the chat when anything is thought as finished for me.</li>
</ul></li>
<li>Any recommended latest papers for?
<ul>
<li>https://arxiv.org/abs/2205.07809</li>
<li>https://arxiv.org/abs/2201.00822</li>
<li>(Focus on the intro/abs)</li>
</ul></li>
</ul></li>
<li>Todo:
<ul>
<li>Read more latest papers to finalize the intro.</li>
<li>Review &amp; edit the whole paper firstly with myself.</li>
</ul></li>
<li>Suggestions:
<ul>
<li> for Bayes factor.</li>
<li>To find the previous plot which has Bayes factors of also HTPM (Lineplot, maybe).</li>
<li>Try to reproduce all the sampling for t=10.</li>
</ul></li>
</ol>
<h2 id="section-68">6-20</h2>
<ol type="1">
<li>Plan:
<ul>
<li>Intro</li>
<li>Theory</li>
<li>Plots</li>
<li>Appendix</li>
</ul></li>
</ol>
<h2 id="section-69">6-23</h2>
<ol type="1">
<li><p>Update:</p>
<ul>
<li><p>t0=10 results.</p></li>
<li><p>Waveform: (log_evidence) OM1(snr20), TCTM0(snr20) //OM1(snr100), TCTM0(snr100)</p>
<p>BBH:0150: -13.995, -13.435 // -30.207, -28.121</p>
<p>BBH:1221: -13.021, -12.109 // -22.385, -28.214</p>
<p>BBH:0300: -12.987, -12.058 // -22.314, -27.907</p></li>
<li><p>Introduction completed.</p></li>
</ul></li>
<li><p>Suggestions:</p>
<ul>
<li>Try to collect the latest codes and update them in the GitHub repo.</li>
<li>Other sampling results with different starting time (ideally). (maybe -5, 5, 15, 20).</li>
<li>Make a table (check the posteriors and the trend) for t0=10.</li>
<li>==Switch the mod-com plot and part of the description in append with Fig. 1.==</li>
</ul></li>
</ol>
<h2 id="section-70">7-6</h2>
<ol type="1">
<li><p>Updates:</p>
<ul>
<li>First version of full paper (all parts go through myself).</li>
<li>Different truncation time results (need to rerun the t0=15 case).</li>
<li>Improved plots in paper.</li>
<li>New code for easy auto-sampling/bayes factor calculation/save data and check plots.</li>
</ul></li>
<li><p>Questions/Suggestions:</p>
<ul>
<li><p>Maybe we can start the first-review now?</p></li>
<li><p>Explain why there is difference between SNR=20 and SNR=100.</p></li>
<li><p>Explain way mass is ~0.5-1.5.</p></li>
<li><p>"accounting_group = cbc.imp.pe" may work.</p></li>
</ul></li>
</ol>
<h2 id="section-71">7-20</h2>
<ol type="1">
<li>Corrections update.</li>
<li>Discuss about the constant noise assumption arguments.
<ul>
<li>Try compute the GW150914 like 220, 221 frequncy sensitivity S(f) value.</li>
</ul></li>
<li>Show the different time results
<ul>
<li>Which plots to use in paper?
<ul>
<li>Add the label(range) of the strong evidence (not decisive)</li>
<li>The mass spin plot can also be in the paper.</li>
</ul></li>
</ul></li>
<li>(Extra: ask about probability).
<ul>
<li>The realistic probability can't be given precisely.</li>
</ul></li>
</ol>
<h2 id="section-72">7-28</h2>
<ol type="1">
<li>Update:
<ul>
<li>Different time results section completed.</li>
<li>OM2 running.</li>
</ul></li>
<li>Question:
<ul>
<li>How to deal with comments now?</li>
</ul></li>
<li>Suggestions:
<ul>
<li>Rerun the different time results with scaled SNR.</li>
</ul></li>
</ol>
<h2 id="section-73">8-24</h2>
<ol type="1">
<li>Updates:
<ul>
<li>Correct the SNR decreasing sampling.</li>
</ul></li>
<li>Next step:
<ul>
<li>Editing the latter part of the paper (focus on the results part).</li>
<li>Add some more discussions on the SNR variation in the larger t0 cases.</li>
</ul></li>
<li>Suggestions:
<ul>
<li>Add more descriptions to the plots.</li>
<li>Meet next Friday.</li>
</ul></li>
</ol>
<h2 id="section-74">9-7</h2>
<ol type="1">
<li><p>Update:</p>
<ul>
<li>Correct the SNR decreasing sampling.</li>
<li>Edited accordingly for latter half of the results section. Add some more discussions on the SNR variation in the larger t0 cases.</li>
</ul></li>
<li><p>My schedule in the near future:</p>
<ul>
<li>Qualify exam in Oct. 1st</li>
</ul></li>
<li><p>Discussion:</p>
<ul>
<li><p>Plan:</p>
<ul>
<li>TCTM1 and OM2 sampling for t0=0, SNR=20, 100.</li>
</ul></li>
</ul></li>
</ol>
<h2 id="section-75">9-21</h2>
<ol type="1">
<li>Update:
<ul>
<li>dlogz stucked at ~3 for SNR=20</li>
<li>dlogz stucked at ~90 for a while for SNR=100, could go down to ~30 if running ~50h with 32 cpus.</li>
</ul></li>
<li>Solutions:
<ul>
<li>Check the codes again to see if there could be improvements.
<ul>
<li>Calculate the np.abs(h1_selected)**2</li>
<li>Try remove the interpolation of m/a -- w/tau outside of the function.</li>
</ul></li>
<li>Use different methods in nested-sampling.</li>
<li>apply dlogz=5, and dlogz=50 for all the tests (rerun the former ones).</li>
</ul></li>
</ol>
<h2 id="section-76">10-13</h2>
<ol type="1">
<li>Check the code
<ul>
<li>/RDFits.ipynb</li>
</ul></li>
<li>Finding scripts.
<ul>
<li>jupyter file</li>
</ul></li>
<li>Suggestions</li>
</ol>
<h2 id="section-77">5-25</h2>
<ol type="1">
<li><p>Time constraints for each one?</p>
<ul>
<li>Me: no actual time constraint, should be more efficient than ever (hopefully :)</li>
</ul></li>
<li><p>Updates:</p>
<ul>
<li>Nothing "new"... but I have been reading all the codes, paper, ipynb... once again these days.</li>
<li>The script for MCMC sampling and Bayes factor computing with various setup (t0, SNR, model) is still valid and ready-to-go.</li>
<li>Paper may need to be rewritten for most parts...which shouldn't take too much time though (guess my english improved...)</li>
</ul></li>
<li><p>Plan &amp; To be discussed</p>
<ul>
<li>TCTM1 and OM2 sampling for t0=0, SNR=20, 100.</li>
<li>Our current result: with q=1, TCTM works better, i.e. supporting the nonlinear effects (only for Bayes factor, not mass/spin bias). Is this solid for the main part of paper or we need to add something else?</li>
<li>Any other interesting points we could show in the paper?</li>
</ul></li>
</ol>
<h2 id="section-78">7-13</h2>
<ol type="1">
<li>Update
<ul>
<li>OM2, OM3 full sampling.</li>
<li>Prior of PhenomD.</li>
</ul></li>
<li>Discussion
<ul>
<li>PhenomD prior/other setup.</li>
<li>Use BIC?</li>
</ul></li>
<li>Todolist
<ul>
<li>try priors of OM to be [0.8,1], [0.9,1]... check bayes factors</li>
<li>(fix TCTM2 full sampling.</li>
<li>add OM4.</li>
</ul></li>
</ol>
<h2 id="section-79">8-23</h2>
<ol type="1">
<li>export LAL_DATA_PATH = nrsur_path:$LAL_DATA_PATH</li>
<li>/work/shilpa.kastha/open_catalog/lal_data_for_NRSur/NRSur7dq4.h5</li>
</ol>
<h2 id="section-80">8-31</h2>
<p>Venv solution:</p>
<ol type="1">
<li>In VSCode open your command palette — <code>Ctrl+Shift+P</code> by default</li>
<li>Look for <code>Python: Select Interpreter</code></li>
<li>In <code>Select Interpreter</code> choose <code>Enter interpreter path...</code> and then <code>Find...</code></li>
<li>Navigate to your <code>venv</code> folder — eg, <code>~/pyenvs/myenv/</code> or <code>\Users\Foo\Bar\PyEnvs\MyEnv\</code></li>
<li>In the virtual environment folder choose <code>&lt;your-venv-name&gt;/bin/python</code> or <code>&lt;your-venv-name&gt;/bin/python3</code></li>
</ol>
<h2 id="section-81">9-22</h2>
<ol type="1">
<li>Todo:
<ul>
<li>Mismatch: try fixing the phase or grid on other parameters.</li>
<li>Calculate the epsilon for PhenomD.</li>
<li>Test with OM with 4 parameters.</li>
<li>Different waveform for Ext:CCE.</li>
</ul></li>
</ol>
<h2 id="section-82">9-25</h2>
<ol type="1">
<li>Updates:
<ul>
<li>Bayes factor</li>
</ul></li>
<li>To discuss:
<ul>
<li>Reasoning on instability</li>
<li>EXTCCE.</li>
</ul></li>
<li>In-progress:
<ul>
<li>Epsilon/mismatch plot update.</li>
<li>different time.</li>
<li>different time for 4 parameters of OM3.</li>
</ul></li>
</ol>
<h2 id="section-83">9-26</h2>
<ol type="1">
<li>Updates with Pierre</li>
<li>Timeline/Todo list
<ul>
<li>Draft leftover
<ul>
<li>Intro (Xisco)</li>
<li>Abstract</li>
<li>Conclusion (Xisco)</li>
<li>Results on different waveform as a table (Yi)</li>
</ul></li>
<li>Timeline
<ul>
<li>Section3 first review (Pierre)</li>
<li>1st week, results + intro/conclusion</li>
<li>2nd week, later results + review</li>
<li>3rd week, last review.</li>
</ul></li>
<li>Works in parallel
<ul>
<li>Different time for 4par OM3</li>
<li>Different time for OM0-2</li>
<li>Change the fix4par to sample the highest tone's amp/phase.</li>
<li>Test with other waveform with different truncating times.</li>
</ul></li>
</ul></li>
</ol>
<h2 id="section-84">10-3</h2>
<ol type="1">
<li><p>Which sections in results?</p>
<ul>
<li><p>Subsection A: Bayes factor (potentially also TCTM, HTPM)</p></li>
<li><p>Subsection B: bias plot</p></li>
<li><p>Subsection C: different time</p></li>
<li><p>Subsection D: different waveform</p></li>
</ul></li>
<li><p>Which sections in appendix?</p>
<ul>
<li>4par version rubustness test (with both different time and bias plots) on OM?</li>
<li>Ext-CCE different time plot (or discussion in subsection D)?</li>
<li>prior tests.</li>
</ul></li>
<li><p>Others</p>
<ul>
<li>Try to do HTPM1 sampling.</li>
</ul></li>
</ol>
<h2 id="section-85">10-6</h2>
<ol type="1">
<li>Updates:
<ul>
<li>Different time for ExtCCE still running</li>
<li>Result/appendix part should be done by next</li>
</ul></li>
<li>To be discussed:
<ul>
<li>Confirm about the plan of plots.
<ul>
<li>2 plots for bias. (1 add TCTM, 2 remove one of the overtone model, change color and range.)</li>
<li>Sub A/D come with tables.</li>
<li>Different t0 stays the same (optionally add TCTM0)</li>
</ul></li>
<li>message to convey in each result section.</li>
<li>Introduction to the 4par model? (in results section)</li>
<li>which models to put into the plot.</li>
<li>Timeline for finalizing the project.</li>
</ul></li>
</ol>
<h2 id="section-86">10-11</h2>
<ol type="1">
<li><p>Discussion</p>
<ul>
<li><p>Shorthanded terms.</p>
<p>RD, NR, IMRPhenomD (change the plot), OM, change the bold model name to normal in text.</p>
<p>For all the OM, use <span class="math inline">\(\text{OM}_n\)</span>, u</p></li>
<li><p>table caption</p></li>
</ul></li>
<li><p>How to proceed.</p>
<ul>
<li>Add HTPM1</li>
</ul></li>
<li><p>Updates:</p>
<ul>
<li>Fig. 3: HTPM1, TCTM1, OM2, PhenomD (optionally TCTM0).</li>
<li>Remove 4-par models (maybe appendix).</li>
<li>appendix priors description (refer to ligo catalog paper.)</li>
</ul></li>
<li><p>Remaining test</p>
<p>-Ext-CCE other result in appendix</p></li>
</ol>
<h2 id="section-87">10-25</h2>
<ol type="1">
<li><p>HTPM/TCTM</p>
<ul>
<li>what message should we give</li>
<li>prior looks fine on HTPM?</li>
</ul></li>
<li><p>Plan</p>
<ul>
<li>appendix2 with corner plots for ExtCCE:002.</li>
<li>Extend the Table 2 to include all bayes evidence the same as Table 1?</li>
<li>Others?</li>
</ul></li>
<li><p>Timeline for writing:</p></li>
<li><p>Notes for shortcut:</p>
<ul>
<li>RD, BH</li>
</ul></li>
</ol>
<h2 id="nov-7">Nov 7</h2>
<ol type="1">
<li>Scri decompress code.</li>
<li>Discussion on Ext-CCE's results.</li>
<li>Epsilon distribution.</li>
<li>go through 2a.</li>
<li>OM amplitude prior fix in the table.</li>
</ol>
<h2 id="nov-24">Nov 24</h2>
<ol type="1">
<li>Plan?
<ul>
<li>Fix the OV to OM</li>
<li>Add another table for epsilon in result.5</li>
</ul></li>
</ol>
<h2 id="dec-7">Dec 7</h2>
<ol type="1">
<li>Change slides.</li>
<li>practice 3 more times.</li>
</ol>
<h2 id="dec-19">Dec 19</h2>
<ol type="1">
<li>Adding citation for 2</li>
<li>change the fig. 5 and relevant text in result and conclusion sections.</li>
<li>Reply to the email of vasco.</li>
<li>create arxiv account.</li>
</ol>
<h2 id="jan-10">Jan 10</h2>
<ol type="1">
<li>Ref to add
<ol type="1">
<li>Page 2 intro about starting time.</li>
</ol></li>
<li>mass/spin relation to w/tau.</li>
<li>Submission to arxiv</li>
<li>Submission to PRD</li>
</ol>
<h2 id="feb-9">Feb 9</h2>
<ol type="1">
<li>Test 3,2,0 and compare to HTPM1's first/fundamental tone frequencies.</li>
</ol>
<h2 id="feb-16">Feb 16</h2>
<ol type="1">
<li>OM3, 4 results update, also update V-A-3</li>
<li>II-A-2 add text to the main paper. may refer to the paper.</li>
<li>sort out GC2 and III-D-1, V-A-1, V-E-1.</li>
</ol>
<h2 id="feb-20">Feb 20</h2>
<ol type="1">
<li>Update the OM4 fig and table, comment on caption of Table I about the uncertainties of epsilons as well.</li>
<li>Highlight all text relevant to IMR calibration in main text.</li>
<li>Sort out the GC2 and III-D-1, V-A-1, V-E-1 in reply.</li>
<li>Add texts about IMR not calibrated only for RD to II-C in paper and also V-A or V-E.</li>
<li>Test with high SNR and more nlive points.</li>
</ol>
<h2 id="feb-21">Feb 21</h2>
<ol type="1">
<li>Try new runs for OM4, and compare the posteriors and see what changes we need to make about OM4.</li>
<li>Add texts about SNR choice and possible limitation on the saturation of OM performance in the corresponding text to the reply to VI-1, V-A-3 and page 7, 8.</li>
</ol>
</article></div></main><div class="nav-wrap"><div class="nav"><button class="site-nav"><div class="navicon"></div></button><ul class="nav_items"><li class="nav_item"><a class="nav-page" href="/research"> Research Experiences</a></li><li class="nav_item"><a class="nav-page" href="/About-me"> About Me</a></li><li class="nav_item"><a class="nav-page" href="/Blogs-Notes"> Blogs</a></li><li class="nav_item"><a class="nav-page" target="_blank" rel="noopener" href="https://yiqiu99.github.io/arXiv Daily/"> ArXiv Notes</a></li><li class="nav_item"><a class="nav-page" href="/Gallery"> Gallery</a></li></ul></div><div class="cd-top"><i class="fa fa-arrow-up" aria-hidden="true"></i></div></div><footer id="page_footer"><div class="footer_wrap"><div class="copyright">&copy;2020 - 2025 by Yi Qiu</div><div class="theme-info">Powered by <a target="_blank" href="https://hexo.io" rel="nofollow noopener">Hexo</a> & <a target="_blank" href="https://github.com/PhosphorW/hexo-theme-academia" rel="nofollow noopener">Academia Theme</a></div></div><script>// Include the dark mode toggle JavaScript file
const toggleTheme = document.querySelector('input#theme-switch[type="checkbox"]');

function detectColorScheme() {
    var theme = "light"; // default

    // get last used theme from local cache
    if (localStorage.getItem("theme")) {
        if (localStorage.getItem("theme") === "dark") {
            theme = "dark";
        }
    } else if (!window.matchMedia) {
        // matchMedia not supported  
        return false;
    } else if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
        // OS has set Dark Mode
        theme = "dark";
    }

    // set detected theme
    if (theme === "dark") {
        setThemeDark();
    } else {
        setThemeLight();
    }
}

function setThemeDark() {
    localStorage.setItem('theme', 'dark');
    document.documentElement.setAttribute('data-theme', 'dark');
    toggleTheme.checked = true;
}

function setThemeLight() {
    localStorage.setItem('theme', 'light');
    document.documentElement.setAttribute('data-theme', 'light');
    toggleTheme.checked = false;
}

// Listener for theme change by toggle
toggleTheme.addEventListener('change', function (e) {
    if (e.target.checked) {
        setThemeDark();
    } else {
        setThemeLight();
    }
}, false);

// Listener for theme change by OS
var toggleOS = window.matchMedia('(prefers-color-scheme: dark)');
toggleOS.addEventListener('change', function (e) {
    if (e.matches) {
        setThemeDark();
    } else {
        setThemeLight();
    }
});

// call theme detection
detectColorScheme();</script></footer><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery-pjax@latest/jquery.pjax.min.js"></script><script src="/js/main.js"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>